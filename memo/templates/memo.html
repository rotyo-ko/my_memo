{% extends "base.html" %}
{% load memo_extras %}

{% block title %}まいめも メモ一覧{% endblock %}

{% block header %}メモ一覧{% endblock %}

{% block content %}
<div class="container">
  <div class="card">
    <form class="my-2 mx-3" method="get">
      <select name="category">
        <option value="">すべてのカテゴリー</option>
        <option value="work">仕事</option>
        <option value="personal">個人</option>
        <option value="study">勉強</option>
        <option value="hobby">趣味</option>
        <option value="other">その他</option>
      </select>
      <button class="btn btn-primary mx-3 hover-opacity">選択</button>
    </form>
  <!--
  <table class="table">
    <thead>
        <tr>
          <th class="text-center">重要度</th>
          <th class="text-center">カテゴリー</th>
          <th>タイトル</th>
          <th>内容</th>
          <th class="text-end px-5">作成日</th>
        </tr>
      </thead>
    <tbody>  
    {% for memo in page_obj %}
    <tr>
      <td class="text-center">{{ memo.priority|stars }}</td>
      <td class="text-center">{{ memo.category }}</td>
      <td>
        <a class="fw-bold"href="{% url 'memo:detail' slug=memo.slug %}">{{ memo.title }}</a>
      </td>
      <td>{{ memo.content|truncatechars:15 }}</td>
      <td class="text-end px-5">{{ memo.created_at|date:"Y-m-d H:i:s" }}</td>
    </tr>
    {% endfor %}
    {% if not page_obj.object_list %}
      <p class="text-center">まだメモはありません</p>
    {% endif %}
    </tbody>
    </table>
  --!>    
    <!--カード型のリスト-->

    <div class="row">
      {% for memo in page_obj %}
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ memo.title }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ memo.category }} | 重要度: {{ memo.priority|stars }}</h6>
            <p class="card-text">{{ memo.content|truncatechars:50|linebreaksbr }}</p>
            <div class="mt-auto">
              <a href="{% url 'memo:detail' slug=memo.slug %}" class="btn btn-primary hover-opacity" style="background-color: rgb(138, 98, 219);">詳細</a>
              
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>  
  <!--ページネーション-->
  <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if page_obj.has_previous %}
            <li class="page-item">
              <a class="page-link hover-opacity href="?page={{ page_obj.previous_page_number }}">«</a>
            </li>
          {% endif %}

          <!--現在のページの前後3ページのリンクを表示-->
          {% for num in page_obj.paginator.page_range %}
           {% if num >= page_obj.number|add:'-3' and num <= page_obj.number|add:'3' %}
              {% if page_obj.number == num %}
                <li class="page-item active" aria-current="page">
                  <span class="page-link">{{ num }}</span>
                </li>
              {% else %}
                <li class="page-item">
                  <a class="page-link hover-opacity" href="?page={{ num }}">{{ num }}</a>
                </li>
              {% endif %}
            {% endif %}
          {% endfor %}
      
          {% if page_obj.has_next %}
          <li class="page-item">  
            <a class="page-link hover-opacity" href="?page={{ page_obj.next_page_number }}">»</a>
          </li>
          {% endif %}
        </ul>
      </nav>
</div>



{% endblock %}